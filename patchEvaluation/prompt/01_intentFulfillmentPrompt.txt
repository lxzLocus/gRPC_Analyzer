# Role
You are an expert code reviewer evaluating whether an LLM agent's output fulfills the intent described in a Git commit message.

---

## Your Task

Evaluate whether the agent's modifications (or decision to make no changes) align with the intent described in the commit message.

### Important Context
- The agent may have made changes, or decided "No Changes Needed"
- A "No Changes Needed" decision can be valid if the described intent is already satisfied or requires a multi-stage approach
- Focus on **intent alignment**, not patch correctness (that's evaluated separately)

---

## Evaluation Criteria

### Intent Fulfillment Label (Choose ONE)

| Label | Description | Score Equivalent |
| :--- | :--- | :--- |
| **FULLY_FULFILLED** | Agent output completely implements the described intent | 1.0 |
| **SUBSTANTIALLY_FULFILLED** | Agent output substantially implements the intent with minor gaps | 0.8 |
| **PARTIALLY_FULFILLED** | Agent output partially addresses the intent | 0.5 |
| **MINIMALLY_FULFILLED** | Agent output is directionally correct but very incomplete | 0.2 |
| **NOT_FULFILLED** | Agent output does not address the intent at all | 0.0 |

### Special Cases

**No Changes Needed (Agent made no modifications):**
- Label **FULLY_FULFILLED** if: The described intent is already implemented, or requires changes outside the current scope
- Label **NOT_FULFILLED** if: The described intent clearly requires changes that the agent should have made

**Partial Implementation:**
- If the commit message describes multiple changes and the agent only implemented some, use **PARTIALLY_FULFILLED** or **SUBSTANTIALLY_FULFILLED** based on coverage

---

## Input Information

### Commit Message
```
Subject: {{commit_subject}}

Body:
{{commit_body}}
```

### Agent Output
{{#if agent_made_changes}}
**Agent made the following modifications:**
```diff
{{agent_generated_diff}}
```
{{else}}
**Agent Decision: No Changes Needed**

Agent's reasoning:
{{agent_reasoning}}
{{/if}}

{{#if agent_thought_process}}
### Agent's Thought Process
{{agent_thought_process}}
{{/if}}

---

## Your Response Format

Provide your evaluation in the following JSON format:

```json
{
  "intent_fulfillment": {
    "label": "NOT_FULFILLED",
    "reasoning": "Explain whether the agent's output aligns with the commit message intent. Be specific about what was expected vs. what was delivered.",
    "commit_intent_summary": "Brief summary of what the commit message describes (1-2 sentences)",
    "agent_output_summary": "Brief summary of what the agent actually did (1-2 sentences)",
    "alignment_analysis": "Detailed analysis of alignment or misalignment"
  }
}
```

### Response Guidelines

1. **Be objective**: Focus on alignment with stated intent, not code quality
2. **Consider context**: "No Changes Needed" can be valid
3. **Be specific**: Reference specific parts of the commit message
4. **Separate concerns**: Don't penalize for implementation details if the intent is met
5. **Use labels consistently**: Choose the label that best matches the degree of fulfillment

---

## Examples

### Example 1: Full Implementation
**Commit:** "Add validation for email field in user registration"
**Agent:** Added email validation logic
**Label:** FULLY_FULFILLED
**Reasoning:** "The commit describes adding email validation, and the agent implemented comprehensive email validation with regex and format checks."

### Example 2: Valid No-op
**Commit:** "Refactor database connection pooling"
**Agent:** No Changes Needed - "Current implementation already uses connection pooling"
**Label:** FULLY_FULFILLED
**Reasoning:** "The agent correctly identified that the described intent (connection pooling) is already implemented in the codebase."

### Example 3: Misalignment
**Commit:** "Update API endpoint to return user preferences"
**Agent:** No Changes Needed
**Label:** NOT_FULFILLED
**Reasoning:** "The commit clearly describes adding new functionality (returning user preferences), but the agent made no changes without valid justification."

### Example 4: Partial Implementation
**Commit:** "Add caching for user queries and update logging"
**Agent:** Implemented caching but did not update logging
**Label:** PARTIALLY_FULFILLED
**Reasoning:** "The commit describes two changes. The agent implemented caching (50%) but did not address the logging update (50%)."

---

## Begin Evaluation

Evaluate the following case and respond with JSON only.
