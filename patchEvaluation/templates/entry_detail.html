<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Ç®„É≥„Éà„É™„ÉºË©≥Á¥∞: {{entryId}}</title>
    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            min-height: 100vh;
        }
        .container { 
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
        }
        .title { 
            font-size: 2.5em;
            margin: 0;
            font-weight: 300;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .entry-id { 
            font-size: 1.1em;
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-family: monospace;
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 6px;
            display: inline-block;
        }
        .content { padding: 30px; }
        
        .section { 
            margin: 30px 0;
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            border-left: 4px solid #4f46e5;
        }
        .section-title { 
            color: #1e293b;
            font-size: 1.5em;
            margin: 0 0 20px 0;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-grid { 
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .info-card { 
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-left: 3px solid #4f46e5;
        }
        .info-label { 
            font-weight: 600;
            color: #64748b;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        .info-value { 
            color: #1e293b;
            font-size: 1.1em;
            word-break: break-all;
        }
        
        .file-list { 
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .file-item { 
            background: white;
            margin: 8px 0;
            padding: 12px 15px;
            border-radius: 6px;
            border-left: 3px solid #10b981;
            font-family: monospace;
            font-size: 0.9em;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .code-block { 
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            max-height: 400px;
            overflow-y: auto;
        }
        .code-block pre { margin: 0; }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .status-success { background: #dcfce7; color: #166534; }
        .status-error { background: #fef2f2; color: #dc2626; }
        .status-warning { background: #fef3c7; color: #d97706; }
        
        /* ÊÑèÂë≥ÁöÑÈ°û‰ººÂ∫¶„Çπ„Ç≥„Ç¢„Éê„ÉÉ„Ç∏ */
        .score-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            min-width: 40px;
            text-align: center;
            color: white;
            background: #6b7280;
        }
        .score-badge.perfect {
            background: linear-gradient(135deg, #059669, #10b981);
            box-shadow: 0 2px 4px rgba(5, 150, 105, 0.3);
        }
        .score-badge.near-perfect {
            background: linear-gradient(135deg, #0d9488, #14b8a6);
            box-shadow: 0 2px 4px rgba(13, 148, 136, 0.3);
        }
        .score-badge.high {
            background: linear-gradient(135deg, #0891b2, #06b6d4);
            box-shadow: 0 2px 4px rgba(8, 145, 178, 0.3);
        }
        .score-badge.medium {
            background: linear-gradient(135deg, #d97706, #f59e0b);
            box-shadow: 0 2px 4px rgba(217, 119, 6, 0.3);
        }
        .score-badge.low {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            box-shadow: 0 2px 4px rgba(220, 38, 38, 0.3);
        }
        .score-badge.very-low {
            background: linear-gradient(135deg, #991b1b, #dc2626);
            box-shadow: 0 2px 4px rgba(153, 27, 27, 0.3);
        }
        
        .evaluation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .evaluation-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .evaluation-score {
            font-size: 2em;
            font-weight: 700;
            margin-bottom: 8px;
        }
        .evaluation-label {
            color: #64748b;
            font-size: 0.9em;
            font-weight: 500;
        }
        
        .footer { 
            background: #f1f5f9;
            padding: 20px 30px;
            text-align: center;
            border-top: 1px solid #e2e8f0;
        }
        .timestamp { 
            color: #64748b;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        .footer-links a {
            color: #4f46e5;
            text-decoration: none;
            margin: 0 15px;
            font-size: 0.9em;
        }
        .footer-links a:hover {
            text-decoration: underline;
        }
        
        @media (max-width: 768px) {
            body { padding: 10px; }
            .content { padding: 20px 15px; }
            .title { font-size: 2em; }
            .info-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">üìù „Ç®„É≥„Éà„É™„ÉºË©≥Á¥∞„É¨„Éù„Éº„Éà</h1>
            <div class="entry-id">ID: {{entryId}}</div>
        </div>

        <div class="content">
            <!-- Âü∫Êú¨ÊÉÖÂ†± -->
            <div class="section">
                <h2 class="section-title">üìä Âü∫Êú¨ÊÉÖÂ†±</h2>
                <div class="info-grid">
                    <div class="info-card">
                        <div class="info-label">„Éá„Éº„Çø„Çª„ÉÉ„Éà„Ç®„É≥„Éà„É™„Éº</div>
                        <div class="info-value">{{datasetEntry}}</div>
                    </div>
                    <div class="info-card">
                        <div class="info-label">APR„É≠„Ç∞„Éë„Çπ</div>
                        <div class="info-value">{{aprLogPath}}</div>
                    </div>
                    {{#if logFiles}}
                    <div class="info-card">
                        <div class="info-label">„É≠„Ç∞„Éï„Ç°„Ç§„É´Êï∞</div>
                        <div class="info-value">{{logFiles.length}}</div>
                    </div>
                    {{/if}}
                    {{#if latestLogFile}}
                    <div class="info-card">
                        <div class="info-label">ÊúÄÊñ∞„É≠„Ç∞„Éï„Ç°„Ç§„É´</div>
                        <div class="info-value">{{latestLogFile}}</div>
                    </div>
                    {{/if}}
                </div>
            </div>

            <!-- APR„É≠„Ç∞Ëß£ÊûêÁµêÊûú -->
            {{#if aprLogData}}
            <div class="section">
                <h2 class="section-title">üîç APR„É≠„Ç∞Ëß£ÊûêÁµêÊûú</h2>
                <div class="info-grid">
                    <div class="info-card">
                        <div class="info-label">ÂØæË©±„Çø„Éº„É≥Êï∞</div>
                        <div class="info-value">{{aprLogData.turns}}</div>
                    </div>
                    <div class="info-card">
                        <div class="info-label">Á∑è„Éà„Éº„ÇØ„É≥Êï∞</div>
                        <div class="info-value">{{aprLogData.totalTokens}}</div>
                    </div>
                    <div class="info-card">
                        <div class="info-label">‰øÆÊ≠£ÂõûÊï∞</div>
                        <div class="info-value">{{aprLogData.modifications}}</div>
                    </div>
                    <div class="info-card">
                        <div class="info-label">ÂΩ±Èüø„Éï„Ç°„Ç§„É´Êï∞</div>
                        <div class="info-value">{{aprLogData.affectedFiles}}</div>
                    </div>
                </div>
            </div>
            {{/if}}

            <!-- Â§âÊõ¥„Éï„Ç°„Ç§„É´Ôºà„Éá„Éº„Çø„Çª„ÉÉ„ÉàÔºâ -->
            {{#if changedFiles}}
            <div class="section">
                <h2 class="section-title">üìÅ Â§âÊõ¥„Éï„Ç°„Ç§„É´Ôºà„Éá„Éº„Çø„Çª„ÉÉ„ÉàÔºâ</h2>
                <ul class="file-list">
                    {{#each changedFiles}}
                    <li class="file-item">{{this}}</li>
                    {{/each}}
                </ul>
            </div>
            {{/if}}

            <!-- APRÂ∑ÆÂàÜ„Éï„Ç°„Ç§„É´ -->
            {{#if aprDiffFiles}}
            <div class="section">
                <h2 class="section-title">üéØ APRÂ∑ÆÂàÜ„Éï„Ç°„Ç§„É´</h2>
                <ul class="file-list">
                    {{#each aprDiffFiles}}
                    <li class="file-item">{{this}}</li>
                    {{/each}}
                </ul>
            </div>
            {{/if}}

            <!-- Ground Truth Diff -->
            {{#if groundTruthDiff}}
            <div class="section">
                <h2 class="section-title">üìä Ground Truth Diff</h2>
                <div class="code-block">
                    <pre>{{groundTruthDiff}}</pre>
                </div>
            </div>
            {{/if}}

            <!-- LLMË©ï‰æ°ÁµêÊûú -->
            {{#if llmEvaluation}}
            <div class="section">
                <h2 class="section-title">ü§ñ LLMË©ï‰æ°ÁµêÊûú</h2>
                <div class="evaluation-grid">
                    <div class="evaluation-card">
                        <div class="evaluation-score">
                            {{#if llmEvaluation.is_correct}}
                            <span style="color: #10b981;">‚úÖ</span>
                            {{else}}
                            <span style="color: #ef4444;">‚ùå</span>
                            {{/if}}
                        </div>
                        <div class="evaluation-label">Ê≠£Á¢∫ÊÄß</div>
                    </div>
                    <div class="evaluation-card">
                        <div class="evaluation-score">
                            {{#if llmEvaluation.is_plausible}}
                            <span style="color: #10b981;">‚úÖ</span>
                            {{else}}
                            <span style="color: #ef4444;">‚ùå</span>
                            {{/if}}
                        </div>
                        <div class="evaluation-label">Â¶•ÂΩìÊÄß</div>
                    </div>
                    {{#if llmEvaluation.semantic_similarity_score}}
                    <div class="evaluation-card">
                        <div class="evaluation-score">
                            <span class="score-badge {{llmEvaluation.similarity_category}}">{{llmEvaluation.semantic_similarity_score}}</span>
                        </div>
                        <div class="evaluation-label">ÊÑèÂë≥ÁöÑÈ°û‰ººÂ∫¶</div>
                        <div style="font-size: 0.8em; color: #6b7280; margin-top: 5px;">
                            {{#gte llmEvaluation.semantic_similarity_score 0.9}}ÂÆåÂÖ®‰∏ÄËá¥{{/gte}}
                            {{#lt llmEvaluation.semantic_similarity_score 0.9}}{{#gte llmEvaluation.semantic_similarity_score 0.8}}È´òÈ°û‰ºº{{/gte}}{{/lt}}
                            {{#lt llmEvaluation.semantic_similarity_score 0.8}}{{#gte llmEvaluation.semantic_similarity_score 0.6}}‰∏≠È°û‰ºº{{/gte}}{{/lt}}
                            {{#lt llmEvaluation.semantic_similarity_score 0.6}}{{#gte llmEvaluation.semantic_similarity_score 0.4}}‰ΩéÈ°û‰ºº{{/gte}}{{/lt}}
                            {{#lt llmEvaluation.semantic_similarity_score 0.4}}‰ΩéÈ°û‰ºº{{/lt}}
                        </div>
                    </div>
                    {{/if}}
                </div>
                {{#if llmEvaluation.similarity_reasoning}}
                <div style="margin-top: 20px;">
                    <div class="info-card">
                        <div class="info-label">È°û‰ººÂ∫¶Âà§ÂÆöÁêÜÁî±</div>
                        <div class="info-value">{{llmEvaluation.similarity_reasoning}}</div>
                    </div>
                </div>
                {{/if}}
                <div style="margin-top: 20px;">
                    <div class="info-card">
                        <div class="info-label">Á∑èÂêàË©ï‰æ°</div>
                        <div class="info-value">
                            <span class="status-badge {{#if llmEvaluation.is_correct}}status-success{{else}}status-error{{/if}}">
                                {{llmEvaluation.overall_assessment}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            {{/if}}

            <!-- ÊúÄÁµÇ‰øÆÊ≠£ÊÉÖÂ†± -->
            {{#if finalModification}}
            <div class="section">
                <h2 class="section-title">üîß ÊúÄÁµÇ‰øÆÊ≠£ÊÉÖÂ†±</h2>
                <div class="info-grid">
                    <div class="info-card">
                        <div class="info-label">‰øÆÊ≠£„Çø„Éº„É≥</div>
                        <div class="info-value">Turn {{finalModification.turn}}</div>
                    </div>
                    <div class="info-card">
                        <div class="info-label">„Çø„Ç§„É†„Çπ„Çø„É≥„Éó</div>
                        <div class="info-value">{{finalModification.timestamp}}</div>
                    </div>
                    <div class="info-card">
                        <div class="info-label">‰øÆÊ≠£Ë°åÊï∞</div>
                        <div class="info-value">{{finalModification.diffLines}}</div>
                    </div>
                    <div class="info-card">
                        <div class="info-label">ÂΩ±Èüø„Éï„Ç°„Ç§„É´Êï∞</div>
                        <div class="info-value">{{finalModification.affectedFiles.length}}</div>
                    </div>
                </div>
            </div>
            {{/if}}
        </div>

        <div class="footer">
            <div class="timestamp">„É¨„Éù„Éº„ÉàÁîüÊàêÊó•ÊôÇ: {{timestamp}}</div>
            <div class="footer-links">
                <a href="#" onclick="window.print()">üìÑ Âç∞Âà∑</a>
                <a href="{{jsonDataPath}}" target="_blank">üìä JSON„Éá„Éº„Çø</a>
                <a href="#" onclick="history.back()">‚Üê Êàª„Çã</a>
            </div>
        </div>
    </div>
</body>
</html>
