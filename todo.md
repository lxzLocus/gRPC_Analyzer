# TODO: I/O処理最適化

## 🔥 最も時間がかかる処理 TOP 4

### **1位: ファイル読み込み処理（readFileWithTimeout）**
- **影響度**: 🔥🔥🔥 **最高**
- **問題**: **順次処理**で並行化されていない
- **推定時間**: 巨大ファイル(10-50MB): **1-5秒**
- **改善案**: Promise.allによる並行処理 → **90%時間短縮**

### **2位: ディレクトリ構造取得（getSurroundingDirectoryStructure）**
- **影響度**: 🔥🔥 **高**
- **問題**: ディレクトリの再帰探索とJSON構造構築
- **推定時間**: 100-500ms/ディレクトリ
- **改善案**: 探索深度制限、キャッシュ機構

### **3位: バッチファイル存在確認（batchFileExistenceCheck）**
- **影響度**: 🔥 **中**
- **現状**: **すでに最適化済み**（Promise.allで並行処理）
- **推定時間**: 1-10ms/ファイル
- **対応**: 現状維持

### **4位: ファイル変更検知（detectFileChangeStatus）**
- **影響度**: 🔥 **低**
- **問題**: リニア検索でO(n)の時間計算量
- **推定時間**: 1-5ms/ファイル
- **改善案**: Set使用でO(1)検索

## 🎯 5分タイムアウト問題の根本原因
**大きなファイル（10-50MB）を順次読み込み** → **1ファイル5秒 × 60ファイル = 300秒でタイムアウト**

## 📈 改善効果予測
| ファイル数 | 現在（順次） | 改善後（並行） | 短縮効果 |
|-----------|------------|---------------|----------|
| 10ファイル | 500ms | 50ms | **90% 削減** |
| 50ファイル | 2.5秒 | 250ms | **90% 削減** |
| 100ファイル | 5秒 | 500ms | **90% 削減** |

